\documentclass[../Bachelorarbeit.tex]{subfiles}
\begin{document}

\chapter{The Leverage Cycle}
\label{ch:leverageCycle}

In this chapter the model for the simulation is given. All the following chapters build upon this model where the thesis-software is an implementation of it. 

\section{Geanakoplos}
The model of \cite{Breuer2015} which is discussed in the next section is based upon the works of John Geanakoplos article \cite{Geanakoplos2009} "The Leverage Cycle" thus for a better understanding a short overview of the innovations and influences found therein is given.

\medskip

The work of Geanakoplos focuses on asset-pricing, the influence of leverage on asset-prices and how leverage affects crises. He claims that because of leverage during boom times the asset-prices are too high because of massive leverage and during bad times the asset-prices are too low because of a massive drop in leverage. That is what he terms "the leverage cycle". Further he predicts that leverage cycles will occur although people remember past ones unless the central bank tries to stop those cycles by regulating leverage. Geanakoplos proposes a theory of equilibrium leverage and asset pricing which gives a central bank a tool for regulating leverage during boom times to prevent asset-prices skyrocketing and reinforce leverage in down times to lift the asset-prices which are too low to a reasonable level.

\medskip

For Geanakoplos all crises start with scary bad news which are then the reason why asset-prices drop below a price which is lower than everyone expected. He introduces the so-called "natural buyer" which is an agent who values the asset more than the public. This can be because the agent is less risk averse, get more utility out of it, use the asset more efficient. In the end the details matter not, the natural buyer is just more optimistic than the public.
To prevent a too specific distinction between the natural buyer and the public Geanakoplos introduces a range of optimism \textit{h} $\in$ \textit{H} = [0..1] in which all agents are ordered by their optimism \textit{h} where the extreme pessimists reside at the lower end of 0.0 and the extreme optimists ate the upper end of 1.0. Each agent assigns the probability that good news will occur according to its optimism \textit{h} where the extreme optimist thinks that good news will happen for sure and the extreme optimist think that it will never occur thus the more optimistic an agent, the more a natural buyer it is. If the natural buyers drops out of the business then the asset-prices drop as the natural buyers are the only ones willing to drive asset-prices up through leverage as they value the asset-prices the most. Thus the natural buyers buy as many assets they can and buy even more assets through borrowing and using the assets as security thus creating leverage. Because of this mechanics Geanakoplos emphasises that it is of very importance who lost money in a crisis - the public or the natural buyers whereas a loss for the natural buyers is the real catastrophe.

\medskip
Geanakoplos then introduces a two-period economy which is the base for the economy used by Breuer et al. in their model. In the first period each agent of the previously mentioned continuum \textit{H} is endowed with one consumption good C and one asset Y and can then trade with each other. The second period can be one of two states: U(p) and D(own) whereas in the up-state the asset Y is worth 1.0 and in the Down-State only 0.2. The agents differ only in their optimism \textit{h} by which they assign the probability that the up-state will happen tomorrow in the second period. According to this they trade on the market according to their utility-function which depends on their optimism \textit{h}. The following formula gives the utility-function of each agent which gives the price of an asset which is how much an agent values it - obviously the more optimistic the higher the price.

\begin{equation}
price = h + (1 - h)0.2
\end{equation}

Now if \textit{price} is larger than some given price \textit{p} then the agent will want to buy the asset as the agent values it more than the given price \textit{p} but can buy it for a lower price thus making an expected profit. If the \textit{price} is less than the given price \textit{p} the agent is going to sell the asset as the value the agent assigns to it is lower than the given price \textit{p} thus the agent can make an expected profit in selling it.

\medskip
Geanakoplos introduces a loan market where agents can lend and borrow money through loans to be able to further buy assets after they have ran out of cash. A loan can be sold and bought for \textit{j} = 0.2 and because lenders worry about default each loan needs to be backed up by an asset as security. Loans need to be paid back at the beginning of the second state. Regarding the up-state the borrower will pay back the initial value of the loan which is \textit{j} = 0.2. In the down-state either 0.2 or the asset will be given back thus it is a risk-less loan as the borrower lost no money in the down-state. TODO: genauer begründen wieso risk-free (an breuer-paper anlehnen)
\linebreak
Geanakoplos then predicts the so called \textit{marginal buyer} around \textit{h} = 0.69. All agents with \textit{h} $<$ 0.69 are pessimists and sell their assets. All agents above \textit{h} $>$ 0.69 are optimists and buy all the assets the pessimists sell either through cash or buy borrowing money from the pessimists through loans and using the borrowed money to buy further assets which then in turn act as security - the leverage is endogenous.
\linebreak
Geanakoplos then makes the distinction between not only one \textit{j} = 0.2 loan but multiple loans with \textit{j} $>$ 0.2 where in the up-state they promise their initial value \textit{j} and in the down-state they deliver only 0.2 thus those loans with \textit{j} $>$ 0.2 are risky loans. He then shows that if there exist markets for all type of bonds which include the risk-less bond \textit{j} = 0.2 then only the risk-less bond will be traded. TODO: show min-gleichungen: dass immer das kleinere zurückgezahlt wird

\medskip

TODO: handle equilibrium theory presented. zuerst einmal alles hier hinein, falls es theoretisch wird, dann in theory hinein nehmen - wird wahrscheinlich der fall sein.
erklären wie bzw. was die equilibrium theory bei geanakoplos ist und kurz erkläutern.
TODO: zuerst wikipedia-artikel und equilibrium-theory genauer herausarbeiten

\medskip

Note that this is only a small part of the quite involved economic theory. Geanakoplos does not stop at this point but this overview is already enough to get the basic influences found in the work of \cite{Breuer2015}.

\section{Breuer et al.}
As already outlined the model of Breuer is heavily influenced by the work of Geanakoplos with the major difference that it is not a pure static equilibrium theory but is a simulation-process which approaches the equilibrium iteratively over time. Also a major achievement is that not only assets and bonds are traded against cash but the model has been extended by an additional market which allows collateralized assets to be traded. According to the authors of \cite{Breuer2015} this is the first time that the trading of leveraged assets was investigated in a continuous double-auction environment. It is also of very importance to note that although the up- and down-states are in this model too they are actually never realized, act only as a model and thus only the first period is simulated TODO: dieser satz macht wenig sinn, anders formulieren. Furthermore agents are not an infinite continuum but finite entities because the equilibrium-solving is done as an iterative simulation-process in software and thus finite agents are required.

The major differences to the approach of Geanakoplos are:
\begin{enumerate}
\item Collateralized assets are traded in addition to the other markets.
\item Up- and down-states are never realized but only the first period is simulated.
\item There are a finite number of agents as opposed to a continuum.
\item Equilibrium with risk-free bonds not available.
\item It is an auction-process over time which iteratively approaches theoretical equilibrium where Geanakoplos is a static equilibrium theory. The mechanism used in this auction is a continuous double-auction.
\end{enumerate}

In the following sections some details which are different to the model of Geanakoplos or need more explanation are discussed.

\subsection{States}
Both the up- and the down-state are the same as in Geanakoplos where the Up-State is denoted with pU and the Down-State is denoted as pD. Assets are worth 1.0 in pU and 0.2 in pD which is the same as in \cite{Geanakoplos2009}. Agents denote with their optimism how likely the up-state will occur.

\subsection{Collateralized asset market}
One of the major inventions of the work of Breuer et al. is the introduction of a market for collateralized assets which has never been studied in continuous double-auction simulations so far. This market enables an agent which is out of cash but high on assets to buy additional assets by selling bonds and thus borrowing money which the agent uses to buy the wanted assets and in return using them as security for collateral constraints. For this mechanism to work Breuer et al. had to overcome two major difficulties.

\begin{enumerate}
\item Coordination of asset and bond markets - the buying of an asset and the selling of a bond needs to be coordinated across both markets and happen at the same time.
\item Reversibility of suboptimal trades - earlier trades could have been suboptimal for an agent because it couldn't fully anticipate the behaviour of other agents and thus needs to get out of old trades. Technically speaking this would require to free collateralized assets thus unlocking them and transferring them in to the state of a real asset (no more collateralized, thus being completely owned by the agent).
\end{enumerate}

Breuer et al. proposed solutions to this two difficulties:
\paragraph{ABM mechanism}
The straight-forward solution to the coordination of the asset and bond markets would be to condition a buy offer of an asset to a sell offer of a bond. Breuer et al. reported a problem that "Separate utility improvement in each of the coupled trades is more restrictive than a net sum utility improvement of all coupled trades." which prevents theoretical equilibrium to be reached. Thus they define the market to traded assets directly against bonds thus reducing the involved agents from three to two and removing the coordination-problem because only one product with one price is traded any-more which further resolves the problem with the restrictiveness of utility in the case of two products.

\paragraph{Bond pledgeability}
This problem of reversibility of suboptimal trades was solved in allowing to uncollateralize an asset by buying a bond. Breuer et al. called this mechanism "bond pledgeability" (BP) and showed that without this mechanism the simulation never converges towards the theoretical equilibrium. See chapter \ref{ch:implementation} "Implementation" for details on the implementation of this mechanism.

\subsection{Utilitiy-Functions}
In this section the utilitiy-functions for each market are given. See chapter \ref{ch:implementation} "Implementation" for more details on the markets.

\paragraph{Asset/Cash market}
The asset market is the same as in \cite{Geanakoplos2009} where assets are just bought and sold against cash.

\begin{equation}
p = h + ( 1 - h )pD
\end{equation}

\paragraph{Bond/Cash market}
The bond market acts the same way as described in \cite{Geanakoplos2009}. Collateral acts as enforcement of financial promises and thus for a given amount of loans the same amount of assets must be held as securities. A loan can be bought for a given price which is the face-value \textit{V}. This face-value has to be paid by the borrower in up-state whereas only pD has to be paid in down-state. Again note that up- and down-states are never realized but influence the utility-functions.
\medskip
Risk-less as well as risky bonds are available in the model of \cite{Breuer2015} where the risky bonds are also those with face-value \textit{V} $>$ 0.2. Although breuer et al. allowed more than one loan simultaneously in their model this is not implemented in the thesis-software as it is not the primary focus of this work and would have required substantial changes in the software.

\begin{equation}
p = h V + ( 1 - h )pD
\end{equation}

\paragraph{Asset/Bond market}
The Asset/Bond market trades asset against bonds thus the utility-function is just the ratio of the Asset/Cash utility to the Bond/Cash utility which gives the amount of bonds one asset is worth for a given optimism \textit{h}.

\begin{equation}
p = \frac{\textit{utiliy Asset/Cash}}{\textit{utility Bond/Cash}}
\end{equation}

\subsection{Auction Mechanism}
The auction mechanism used is a continuous double-auction on all markets open at the same time with a finite number of agents. To prevent a bias

\paragraph{Bidding}
To prevent a bias one agent is picked at random and then submits offerings on all markets while respecting the following constraints.

\begin{itemize}
\item If the agent has no more assets it can't sell them either through cash or bonds.
\item The agent cannot buy more assets or bonds than it owns cash.
\item When placing sell-offers of bonds or assets there must not remain bonds which have no collateral as security. 
\end{itemize}

\paragraph{Matching}
Again to prevent a bias pick one market at random and pick at random the buy or sell offers on this market too and compare them with the offers of the previously selected random agent. According to the double-auction mechanism a match occurs only if:

\begin{equation}
\textit{buy-price} \geq \textit{sell-price}
\end{equation}

In this case the offers are deleted from the offering-book and the matching-price is calculated at the half-way price as defined for double-auctions:
\begin{equation}
\textit{matching-price} = \frac{\textit{buy-price} + \textit{sell-price}}{2}
\end{equation}

If no match occurs by the currently picked random agent pick another agent at random and continue as above with submitting its offers on all markets.

\subsection{Equilibrium}
Breuer et al. reported equilibria for prices and allocations both of bonds and assets where the equilibria are fundamentally different whether a risk-free bond is available or not.

\paragraph{Risk-free bond}
If a risk-free bond with a face-value of \textit{V} $\leq$ 0.2 is available then the agents are divided into two subgroups by $i^*$:

\begin{enumerate}
\item Agents with $0 < i \leq i^*$ are pessimists and hold only cash or the risk-free bond with highest face-value.
\item Agents with $i^* < i \leq 1$ are optimists and are maximally short in risk-free bonds with highest face-value and hold only assets.
\end{enumerate}

Below the formulas reported in \cite{Breuer2015} are given for calculating $i^*$, the asset-price \textit{p} and the bond-price \textit{q} in equilibrium.

\begin{equation}
i^* = \frac{p - 0.2}{0.8}
\end{equation}

\begin{equation}
p = \frac{1 + q - i^*}{i^*}
\end{equation}

\begin{equation}
q = 0.2
\end{equation}

\paragraph{Risky bond}
When only a risky bond with face-value \textit{V} $>$ 0.2 is available then the agents divide into three instead of two subgroups separated by $i_{1}$ and $i_{2}$:

\begin{enumerate}
\item Agents with $0 < i \leq i_{1}$ are pessimists and hold only cash.
\item Agents with $i_{1} < i \leq i_{2}$ are median agents and hold only bonds with the lowest face-value.
\item Agents with $i_{2} < i \leq 1$ are optimists and hold only assets and are maximally short in risky bonds with the lowest face-value.
\end{enumerate} 

Below the formulas reported in \cite{Breuer2015} are given for calculating $i_{1}$, $i_{2}$, the asset-price \textit{p} and the bond-price \textit{q} in equilibrium. Note that in this thesis equilibria are always calculated for a risky bond with a face-value of \textit{V} = 0.5.

\begin{equation}
i_{1} = \frac{q - 0.2}{V - 0.2}
\end{equation}

\begin{equation}
i_{2} = \frac{0.2(p - q)}{0.8q - (V - 0.2)p}
\end{equation}

\begin{equation}
p = \frac{1}{i_{1}} - 1
\end{equation}

\begin{equation}
q = p \frac{i_{2} - i{1}}{1 - i_{1}}
\end{equation}

Note that this case is not discussed in \cite{Geanakoplos2009} where it is excluded by assumption.

\medskip

Note that those equations both of the risk-free and risky case are solved iteratively through the simulation-process but can also be solved using Linear Programming (LP) which was used by \cite{Breuer2015} to calculate the theoretical equilibrium using these formulas and comparing the results with the results of their simulation-runs.

\medskip

See chapter \ref{ch:results} "Results" for equilibrium results found in Breuer et al.

\subsection{Endogenous leverage}
Endogenous leverage is the central topic of the models both of Geanakoplos and obviously of Breuer et al. as they've built their model upon the one of Geanakoplos. Because it may seem not immediately clear where and how leverage is endogenous in the model of Breuer et al. this section tries to outline where this is the case and how it is implemented. 

\medskip
In the work of \cite{Breuer2015} it is noted that 
\begin{quote}
"In this theory the amount that can be borrowed against a particular asset to purchase it is determined in the market."
\end{quote}

and furthermore

\begin{quote}
"Leverage, the percentage of the value of the real asset that can be borrowed to purchase it, is determined by contract selection through the market. Leverage is endogenous."
\end{quote}

When an agent buys an asset by borrowing money through selling bonds on the Asset/Bond market then the agent is using leverage to finance the asset trade. Buyers are buying an asset if the utility increases thus assigning the asset a higher value than the seller but still the buyer is paying less than the value he assigns the asset. According to the definition of leverage in chapter \ref{ch:theory} the leverage ratio is:

\begin{equation}
\textit{leverage-ratio} = \frac{\textit{buyer utility-price}}{\textit{buyer-price} - \textit{matching-price}}
\end{equation}

The buyer assigns the asset the value given by the agents utility-price thus the leverage-ratio is then the ratio of this value to the difference between the buyers-price and the price the agent really pays, which is less due to the mechanics of the double-auction. The value in the denominator is the amount the agent does not finance by borrowing - in the case of this model this value is never paid by the agent and is just the expected win if the up-state occurs. This is the leverage which drives up the asset-prices as noted by Geanakoplos.

\medskip

Because the leverage is covered implicitly by the model and not by parameters which are set exogenous from an experimenter the leverage is regarded as endogenous, coming from within the simulation-model itself.

\medskip
TODO: noch beschreiben, was contract-selection ist und collateral equilibrium has both: contract selection and a collateral premium for the real asset.
TODO: endogenizing leverage. prices of assets and debt are distorted through leverage.

Note that the higher the face-value of a bond the higher the utility-price can get thus due to the Asset/Bond utility-function the cheaper an asset is traded against bonds. Geanakoplos and Breuer et al. showed that in case of a risk-free bond is available on the bond market then the one with the highest face-value will be selected and in case of only risky bonds are available only the 


\section{Static equilibrium vs. equilibrium process}
The model of Geanakoplos is static equilibrium theory. Such a theory provides formulas with which for a given price traders maximize their utility. This is inherently static as time is not modelled in this process. Breuer et al. developed a model which tries to reach the equilibrium proposed by Geanakoplos in \cite{Geanakoplos2009} through a trading process between a finite number of agents over time.

\medskip

TODO: theoretisches: utiliy-funktionen und clearing preis, in der simulation: ungeklärt, immer individuell, "steckenbleiben" vs. gleichgewicht, am ende an theoretischem gleichgewicht orientiert
TODO: What is equilibrium in a process? It is NOT when no agents are able to trade anymore.
TODO: Can we give an equilibrium-definition for the dynamic-process? HV: hier ein paar schlaue gedanken dazu?

\end{document}
